{"mappings":"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","sources":["src/js/modal-info-film.js","src/js/card-templete.js","src/js/localStorage.js"],"sourcesContent":["import { refs } from '/src/index.js';\nimport { fetchFilmInfo } from \"/src/js/fetch-film-info\";\nimport { cardTemplate } from \"/src/js/card-templete\";\nimport { fetchFilmPopularity } from \"/src/js/fetch-film-popularity\";\nimport { getLocalSt, setLocalSt, remLocalSt } from './localStorage';\nimport Notiflix from 'notiflix';\n// import { add } from 'lodash';\n\n\nconsole.log(refs);\nrefs.list.addEventListener('click', onCardClickOpenModal);\nrefs.closeModalBtn.addEventListener('click', toggleModal);\n\n// let currentPictSrc = \"\";\nfunction onCardClickOpenModal(e) {\n    console.log(e.target.closest('.film-item'));\n\n    // currentPictSrc = e.target.closest('.film-item img').currentSrc;\n    const filmTemplateId =e.target.closest('.film-item').id;\n    toggleModal();\n\n    fetchFilmInfo(filmTemplateId).then(respFilmInfo).catch(errorFilmInfo);\n};\n\nfunction respFilmInfo(resp) {\n    console.log(resp.data);\n\n    refs.cardList.innerHTML = cardTemplate(resp.data);\n    // refs.cardList.innerHTML = cardTemplate(resp.data,currentPictSrc);\n\n  //-------------------------------------WATCHED-QUEUE----------------------------------------\n\n  const WATCHED_KEY = 'watched';\n  const QUEUE_KEY = 'queue';\n\n  const addQueue = document.querySelector('.add-queue-btn');\n  const addWatched = document.querySelector('.add-watched-btn');\n\n  const makeArr = (id, list) => {\n    let newArr = [];\n    let localArr = getLocalSt(list);\n    if (localArr) {\n      newArr = [...localArr];\n    }\n    const arrSet = new Set(newArr);\n    return arrSet.has(id);\n  };\n\n  async function textWatchDelay() {\n    setTimeout(() => {\n      addWatched.textContent = 'Remove from watched';\n      addWatched.disabled = false;\n    }, 1000);\n  }\n  async function textQueueDelay() {\n    setTimeout(() => {\n      addQueue.textContent = 'Remove from queue';\n      addQueue.disabled = false;\n    }, 1000);\n  }\n  const onWatchedModalBtn = e => {\n    let watchArr = [];\n    const watchObj = data;\n\n    if (addWatched.classList.contains('active')) {\n      console.log(data.id);\n      remLocalSt(WATCHED_KEY);\n\n      let index = watchArr.indexOf(data.id);\n      watchArr.splice(index, 1);\n\n      const stringedWatchArr = JSON.stringify(watchArr);\n      localStorage.setItem(WATCHED_KEY, stringedWatchArr);\n      console.log(stringedWatchArr);\n      Notiflix.Notify.failure('Removed from watched');\n      addWatched.classList.remove('active');\n      addWatched.textContent = 'Add to watched';\n      return;\n    }\n    watchArr.push(watchObj);\n\n    const stringedWatchArr = JSON.stringify(watchArr);\n    localStorage.setItem('watched', stringedWatchArr);\n    console.log(stringedWatchArr);\n\n    addWatched.textContent = 'Added from watched';\n    addWatched.disabled = true;\n\n    textWatchDelay();\n    addWatched.classList.add('active');\n  };\n\n  const onQueueModalBtn = e => {\n    console.log('hello!');\n    e.preventDefault();\n    let queueArr = [];\n    const queueObj = data;\n\n    if (addQueue.classList.contains('active')) {\n      console.log(data.id);\n      remLocalSt(QUEUE_KEY);\n\n      let index = queueArr.indexOf(data.id);\n      queueArr.splice(index, 1);\n\n      const stringedQueueArr = JSON.stringify(queueArr);\n      localStorage.setItem(QUEUE_KEY, stringedQueueArr);\n      console.log(stringedQueueArr);\n      Notiflix.Notify.failure('Removed from queue');\n      addQueue.classList.remove('active');\n      addQueue.textContent = 'Add to queue';\n      return;\n    }\n    queueArr.push(queueObj);\n\n    const stringedQueueArr = JSON.stringify(queueArr);\n    localStorage.setItem('queue', stringedQueueArr);\n    console.log(stringedQueueArr);\n\n    addQueue.textContent = 'Added from queue';\n    addQueue.disabled = true;\n\n    textQueueDelay();\n    addQueue.classList.add('active');\n  };\n\n  addWatched.addEventListener('click', onWatchedModalBtn);\n  addQueue.addEventListener('click', onQueueModalBtn);\n\n  //------------------------------------WATCHED-QUEUE---------------------------\n\n  window.addEventListener('keydown', onEscCloseModal);\n  refs.modal.addEventListener('click', onOutsideClickCloseModal);\n};\nfunction errorFilmInfo(er) {\n    console.log(er);\n    // fetchFilmPopularity();\n    // refs.cardList.innerHTML = \"Sorry we can't load film data!\";\n    window.addEventListener('keydown', onEscCloseModal);\n    refs.modal.addEventListener('click', onOutsideClickCloseModal);\n};\n\nfunction toggleModal() {\n    refs.modal.classList.toggle('is-hidden');\n    refs.modalBody.classList.toggle('no-scroll');\n};\n\n\n\n// ----------------- CLOSE MODAL------------------------------\nfunction onEscCloseModal(e) {\n    if (e.code !== 'Escape') {\n        return;\n    }\n\n    toggleModal();\n    removeAddEventlisteners();\n};\nfunction onOutsideClickCloseModal(e) {\n    // console.log(e.currentTarget);\n    // console.log(e.target);\n    if (e.currentTarget !== e.target) return;\n    toggleModal();\n    removeAddEventlisteners();\n};\nfunction removeAddEventlisteners() {\n    window.removeEventListener('keydown', onEscCloseModal);\n    refs.modal.removeEventListener('click', onOutsideClickCloseModal);\n};\n ","// import { rendserIds } from '/src/index';\n\nconst imgUrl = \"https://image.tmdb.org/t/p/w500/\";\nexport const cardTemplate = ({\n    original_title = \"no data\",\n    vote_average,\n    vote_count,\n    popularity,\n    genres,\n    overview = \"no data\",\n    poster_path }) =>\n `<li class=\"modal_card_container list\">\n    <div class=\"modal_pict_container\">\n        <img class=\"film-img\" src=\"${poster_path === null?\"/src/images/BOX.jpg\":imgUrl + poster_path}\">\n    </div>\n\n    <div class=\"modal_text_container\">\n    \n        <h2 class=\"film_title\">${original_title}</h2>\n\n        <ul class=\"modal_filminfo list\">\n            <li class=\"filminfo_left\"><p class=\"modal_filminfo-data\">Vote / Votes</p></li>\n            <li class=\"filminfo_right\"><p class=\"modal_filminfo-data\"><span class=\"vote_highlighted\">${vote_average.toFixed(1)}</span> / ${vote_count}</p></li>\n\n            <li class=\"filminfo_left\"><p class=\"modal_filminfo-data\">Popularity</p></li>\n            <li class=\"filminfo_right\"><p class=\"modal_filminfo-data\">${popularity}</p></li>\n\n            <li class=\"filminfo_left\"><p class=\"modal_filminfo-data\">Original Title</p></li>\n            <li class=\"filminfo_right\"><p class=\"modal_filminfo-data to-upercase\">${original_title}</p></li>\n\n            <li class=\"filminfo_left\"><p class=\"modal_filminfo-data\">Genre</p></li>\n            <li class=\"filminfo_right\"><p class=\"modal_filminfo-data\">${genres.length === 0?\"no data\":genres.map(genr=>genr.name).join(', ')}</p></li>\n        </ul>\n\n        <h3 class=\"modal_text_container-about to-upercase\">About</h3>\n        <p class=\"modal_text_container-overwiew\">${overview}</p>\n       \n\n        <div class=\"modal_btn_container\">\n            \n            <button class=\"add-watched-btn \"watched-btn btn-text-library btn\" type=\"button\">ADD TO WATCHED</button>\n            <button class=\"add-queue-btn btn\" type=\"button\">ADD TO QUEUE</button> \n        </div>\n    </div>\n</li>`;\n\n// <img class=\"film-img\" src=\"${poster_path === null?currentPictSrc:imgUrl + poster_path}\">","export const getLocalSt = (key) => {\n    try {\n        const gotten = localStorage.getItem(key);\n        return (JSON.parse(gotten) || undefined);\n    } catch (error) {\n        console.log(\"Error\", error);\n    }\n}\nexport const setLocalSt = (key, value) => {\n  try {\n      const setten = JSON.stringify(value);\n      localStorage.setItem(key, setten);\n    \n  } catch (error) {\n    console.log('Error', error);\n  }\n};\nexport const remLocalSt = (key) => {\n  try {\n    return localStorage.removeItem(key);\n  } catch (error) {\n    console.log('Error', error);\n  }\n};\n"],"names":["$2Fivl","parcelRequire","$3b7a0b2bf3290fd5$export$f3d44414f0a0d0b1","original_title","vote_average","vote_count","popularity","genres","overview","poster_path","toFixed","length","map","genr","name","join","$2338c8cd734f85a6$export$c98d67ceb3ef1277","key","localStorage","removeItem","error","console","log","$26aff1fab1158a5e$var$respFilmInfo","resp","data","refs","cardList","innerHTML","WATCHED_KEY","QUEUE_KEY","addQueue","document","querySelector","addWatched","addEventListener","e","watchArr","watchObj","classList","contains","id","index","indexOf","splice","stringedWatchArr","JSON","stringify","setItem","$parcel$interopDefault","$eWCmQ","Notify","failure","remove","textContent","push","disabled","async","setTimeout","textWatchDelay","add","preventDefault","queueArr","queueObj","stringedQueueArr","textQueueDelay","window","$26aff1fab1158a5e$var$onEscCloseModal","modal","$26aff1fab1158a5e$var$onOutsideClickCloseModal","$26aff1fab1158a5e$var$errorFilmInfo","er","$26aff1fab1158a5e$var$toggleModal","toggle","modalBody","code","$26aff1fab1158a5e$var$removeAddEventlisteners","currentTarget","target","removeEventListener","list","closest","filmTemplateId","$7JaeA","fetchFilmInfo","then","catch","closeModalBtn"],"version":3,"file":"index.ea9af12d.js.map"}