{"mappings":"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","sources":["src/js/modal-library.js"],"sourcesContent":["// import { refs } from '/src/index.js';\n// import { fetchFilmInfo } from '/src/js/fetch-film-info';\n// import { cardTemplate } from '/src/js/card-templete';\n// import { fetchFilmPopularity } from '/src/js/fetch-film-popularity';\n// import { getLocalSt, setLocalSt, remLocalSt } from './localStorage';\n// import imgTemplate from '/src/images/BOX.jpg';\n// import Notiflix from 'notiflix';\n// // import { add } from 'lodash';\n\nconsole.log(refs);\nrefs.list.addEventListener('click', onCardClickOpenModal);\nrefs.closeModalBtn.addEventListener('click', toggleModal);\n\n// import { rendserIds } from '/src/index';\n\nconst imgUrl = 'https://image.tmdb.org/t/p/w500/';\n\nexport const cardTemplated = ({\n  original_title = 'no data',\n  vote_average,\n  vote_count,\n  popularity,\n  genres,\n  overview = 'no data',\n  poster_path,\n}) =>\n  `<li class=\"modal_card_container list\">\n    <div class=\"modal_pict_container\">\n        <img class=\"film-img\" loading=\"lazy\"\n         src=\"${poster_path === null ? imgTemplate : imgUrl + poster_path}\">\n    </div>\n\n    <div class=\"modal_text_container\">\n    \n        <h2 class=\"film_title\">${original_title}</h2>\n\n        <ul class=\"modal_filminfo list\">\n            <li class=\"filminfo_left\"><p class=\"modal_filminfo-data\">Vote / Votes</p></li>\n            <li class=\"filminfo_right\"><p class=\"modal_filminfo-data\"><span class=\"vote_highlighted\">${vote_average.toFixed(\n              1\n            )}</span> / ${vote_count}</p></li>\n\n            <li class=\"filminfo_left\"><p class=\"modal_filminfo-data\">Popularity</p></li>\n            <li class=\"filminfo_right\"><p class=\"modal_filminfo-data\">${popularity}</p></li>\n\n            <li class=\"filminfo_left\"><p class=\"modal_filminfo-data\">Original Title</p></li>\n            <li class=\"filminfo_right\"><p class=\"modal_filminfo-data to-upercase\">${original_title}</p></li>\n\n            <li class=\"filminfo_left\"><p class=\"modal_filminfo-data\">Genre</p></li>\n            <li class=\"filminfo_right\"><p class=\"modal_filminfo-data\">${\n              genres.length === 0\n                ? 'no data'\n                : genres.map(genr => genr.name).join(', ')\n            }</p></li>\n        </ul>\n\n        <h3 class=\"modal_text_container-about to-upercase\">About</h3>\n        <p class=\"modal_text_container-overwiew\">${overview}</p>\n       \n\n        <div class=\"modal_btn_container\">\n            \n            <button class=\"add-watched-btn btn\" type=\"button\">ADD TO WATCHED</button>\n            <button class=\"add-queue-btn btn\" type=\"button\">ADD TO QUEUE</button> \n        </div>\n    </div>\n</li>`;\n\n// let currentPictSrc = \"\";\nfunction onCardClickOpenModal(e) {\n  console.log(e.target.closest('.film-item'));\n\n  // currentPictSrc = e.target.closest('.film-item img').currentSrc;\n  const filmTemplateId = e.target.closest('.film-item').id;\n  toggleModal();\n\n  fetchFilmInfo(filmTemplateId).then(respFilmInfo).catch(errorFilmInfo);\n}\n\nfunction respFilmInfo(resp) {\n  console.log(resp.data);\n\n  refs.cardList.innerHTML = cardTemplated(resp.data);\n  // refs.cardList.innerHTML = cardTemplate(resp.data,currentPictSrc);\n\n  //-------------------------------------WATCHED-QUEUE----------------------------------------\n  //Declaration----------------\n  const WATCHED_KEY = 'watched';\n  const QUEUE_KEY = 'queue';\n  const { data } = resp;\n  const addQueue = document.querySelector('.add-queue-btn');\n  const addWatched = document.querySelector('.add-watched-btn');\n\n  let watchArr = [];\n  const watchObj = data;\n  let queueArr = [];\n  const queueObj = data;\n  let stringedWatchArr;\n  let stringedQueueArr;\n\n  //Checks-------------------------\n\n  if (!getLocalSt(WATCHED_KEY)) {\n    setLocalSt(WATCHED_KEY, []);\n  }\n  if (!getLocalSt(QUEUE_KEY)) {\n    setLocalSt(QUEUE_KEY, []);\n  }\n\n  if (getLocalSt(WATCHED_KEY).find(obj => obj.id === data.id)) {\n    addWatched.textContent = 'Remove from watched';\n    addWatched.classList.add('active');\n  }\n  if (getLocalSt(QUEUE_KEY).find(obj => obj.id === data.id)) {\n    addQueue.textContent = 'Remove from queue';\n    addQueue.classList.add('active');\n  }\n\n  //textdelay-----------------------------\n  async function textWatchDelay() {\n    setTimeout(() => {\n      addWatched.textContent = 'Remove from watched';\n      addWatched.disabled = false;\n    }, 1000);\n  }\n  async function textQueueDelay() {\n    setTimeout(() => {\n      addQueue.textContent = 'Remove from queue';\n      addQueue.disabled = false;\n    }, 1000);\n  }\n  async function textWatchDelayPre() {\n    setTimeout(() => {\n      addWatched.textContent = 'Add to watched';\n      addWatched.disabled = false;\n    }, 1000);\n  }\n  async function textQueueDelayPre() {\n    setTimeout(() => {\n      addQueue.textContent = 'Add to queue';\n      addQueue.disabled = false;\n    }, 1000);\n  }\n\n  //Buttons Functionality-----------------------------\n  const onWatchedModalBtn = e => {\n    console.log('hello!');\n    e.preventDefault();\n\n    if (addWatched.classList.contains('active')) {\n      console.log(data.id);\n      watchArr = [];\n      watchArr.push(...getLocalSt(WATCHED_KEY));\n      let index = watchArr.indexOf(data.id);\n      watchArr.splice(index, 1);\n      stringedWatchArr = JSON.stringify(watchArr);\n      localStorage.setItem(WATCHED_KEY, stringedWatchArr);\n      console.log(stringedWatchArr);\n      Notiflix.Notify.failure('Removed from watched');\n      addWatched.classList.remove('active');\n      addWatched.textContent = 'Removed from watched';\n      addWatched.disabled = true;\n      textWatchDelayPre();\n      return;\n    } else {\n      watchArr = [];\n      watchArr.push(...getLocalSt(WATCHED_KEY));\n      watchArr.push(watchObj);\n      stringedWatchArr = setLocalSt(WATCHED_KEY, watchArr);\n\n      console.log(watchArr);\n\n      addWatched.textContent = 'Added from watched';\n      addWatched.disabled = true;\n      textWatchDelay();\n      addWatched.classList.add('active');\n    }\n  };\n  const onQueueModalBtn = e => {\n    console.log('hello!');\n    e.preventDefault();\n\n    if (addQueue.classList.contains('active')) {\n      console.log(data.id);\n      queueArr = [];\n      queueArr.push(...getLocalSt(QUEUE_KEY));\n      let index = queueArr.indexOf(data.id);\n      queueArr.splice(index, 1);\n      const stringedQueueArr = JSON.stringify(queueArr);\n      localStorage.setItem(QUEUE_KEY, stringedQueueArr);\n      console.log(stringedQueueArr);\n      Notiflix.Notify.failure('Removed from queue');\n      addQueue.classList.remove('active');\n      addQueue.textContent = 'Removed from queue';\n      addQueue.disabled = true;\n      textQueueDelayPre();\n    } else {\n      queueArr = [];\n      queueArr.push(...getLocalSt(QUEUE_KEY));\n      queueArr.push(queueObj);\n      stringedQueueArr = JSON.stringify(queueArr);\n      localStorage.setItem('queue', stringedQueueArr);\n      console.log(stringedQueueArr);\n      addQueue.textContent = 'Added from queue';\n      addQueue.disabled = true;\n      textQueueDelay();\n      addQueue.classList.add('active');\n    }\n  };\n\n  addWatched.addEventListener('click', onWatchedModalBtn);\n  addQueue.addEventListener('click', onQueueModalBtn);\n\n  //------------------------------------WATCHED-QUEUE---------------------------\n  window.addEventListener('keydown', onEscCloseModal);\n  refs.modal.addEventListener('click', onOutsideClickCloseModal);\n}\nfunction errorFilmInfo(er) {\n  console.log(er);\n  // fetchFilmPopularity();\n  // refs.cardList.innerHTML = \"Sorry we can't load film data!\";\n  window.addEventListener('keydown', onEscCloseModal);\n  refs.modal.addEventListener('click', onOutsideClickCloseModal);\n}\n\nfunction toggleModal() {\n  refs.modal.classList.toggle('is-hidden');\n  refs.modalBody.classList.toggle('no-scroll');\n}\n\n// ----------------- CLOSE MODAL------------------------------\nfunction onEscCloseModal(e) {\n  if (e.code !== 'Escape') {\n    return;\n  }\n\n  toggleModal();\n  removeAddEventlisteners();\n}\nfunction onOutsideClickCloseModal(e) {\n  // console.log(e.currentTarget);\n  // console.log(e.target);\n  if (e.currentTarget !== e.target) return;\n  toggleModal();\n  removeAddEventlisteners();\n}\nfunction removeAddEventlisteners() {\n  window.removeEventListener('keydown', onEscCloseModal);\n  refs.modal.removeEventListener('click', onOutsideClickCloseModal);\n}\n"],"names":["console","log","refs","list","addEventListener","e","target","closest","filmTemplateId","id","$2631b5b1e00936b8$var$toggleModal","fetchFilmInfo","then","$2631b5b1e00936b8$var$respFilmInfo","catch","$2631b5b1e00936b8$var$errorFilmInfo","closeModalBtn","resp","data","cardList","innerHTML","original_title","vote_average","vote_count","popularity","genres","overview","poster_path","imgTemplate","toFixed","length","map","genr","name","join","$2631b5b1e00936b8$export$57cbc82265d222ac","WATCHED_KEY","QUEUE_KEY","addQueue","document","querySelector","addWatched","watchArr","watchObj","queueArr","queueObj","stringedWatchArr","stringedQueueArr1","getLocalSt","setLocalSt","find","obj","textContent","classList","add","preventDefault","contains","push","index","indexOf","splice","JSON","stringify","localStorage","setItem","Notiflix","Notify","failure","remove","disabled","async","setTimeout","textWatchDelayPre","textWatchDelay","stringedQueueArr","textQueueDelayPre","textQueueDelay","window","$2631b5b1e00936b8$var$onEscCloseModal","modal","$2631b5b1e00936b8$var$onOutsideClickCloseModal","er","toggle","modalBody","code","$2631b5b1e00936b8$var$removeAddEventlisteners","currentTarget","removeEventListener"],"version":3,"file":"library.57613f4f.js.map"}